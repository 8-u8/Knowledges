# QuantumBlack: CausalNex 因果関係を踏まえた正しいモデルの理解と活用

## 機械学習は必ずしも因果関係を導いているわけではない。
- 機械学習の精度だけを突き詰めると、全く異なる結果に陥る可能性がある。

### RCT
- 因果関係のためのデータ
- データ量が限られている + 一般化可能性にも限界が在る

### 観察研究
- 因果関係を考慮せずに生成
- データがいっぱい
- 交絡が存在

## 観察データを扱う際の課題

### 純粋にデータから因果方向を導き出す研究
- Causal Inference via Kernel Deviance Measures
- 因果方向に関する問題
  - P(X|Y)とP(Y|X)の条件付き分布の違い(分散)から、因果方向を推論する

### 交絡を見つけ出す方法
- 完璧な方法はない
  - 傾向スコアやCausal Forest/BART
- QuantumBlack「ベイジアンネットワークしよう」

### エキスパート知識を活用した相互依存関係モデリング
- 親ノードを子ノードに転換する数学的なEncoding
  - 各関数は他の関数の変化に対して自律性を持つ
- DAGを前提するので人間にも理解できる
  - データとドメインの知識を活用するのでハイブリッド学習を行う。
  - DAGs With no Tearsによる計算の難しさが軽減されたらしい
  - 学習した構造をドメイン知識で編集する
    - 因果方向の再学習
    - 欠如した関連性の追加なども可能
- データ量がある場合精度よくやっていける
  - 加法的モデルじゃないので。
  - Junction tree
- 適用先: 病気など

### 因果関係を「学習」する
- What if で反実仮想を行った予測ができる
- CausalNexはいいぞ

## Q&A
- 因果関係の程度とは？
  - 因果関係の定量化が難しいため、確率分布で決めたり、  
  ドメイン知識によるネットワーク学習を行ったりする。
- ドメイン知識によるバイアスは生じる？検知はできる？
  - バイアスは生じうる。誤差は起きうる。
  - CVに近い感じで評価する。
- 精度でいうとXGBとかLGBなどと比べたときのベイジアンネットワークの優位点？
  - 計算時間がメッチャクチャかかるので、精度だけで見るならXGBなどがいい
  - ベイジアンネットワークは力を入れて実装すると、長く使うことができる。このトレードオフだろう。
- CausalNexの限界は？
  - DAGsで表現できないことはできない。
- CausalNexの結果のロバスト性について
  - Confidency intervalの計算→RDで開発中
    - 条件付き分布をサンプリングして評価
    - ブートストラップによる方法
- A→B？B→A？正しいと言える？
  - データから推論する研究があるワケ。
  - ドメイン知識によって補強するのがCausalNexです。
- 因果方向が直感と反する/納得感がない場合？
  - 直感に反する理由が論理的に演繹できない場合納得感がある
  - そうでない場合現場適用は難しい。
  - アジャイル的に回してやっていくことで改善できる可能性もある。
- モデルに使っている変数ってどうするんですか？
  - スタートは「どういう課題を解こうとしているのか」「どの領域にインパクトがあるか」
  - その次に「どういうデータがあるのか」
  - さらに「どういう道具を使うか」「変数をどうするか」
- データ量が膨大の場合、適用領域が狭まる？使える業界は？
  - 計算量がべらぼうにかかるんだぜ
- 計算のスピードやスケーラビリティについて
  - TPUとか使って速くする可能性がある
    - Pytorch Extention使うと5000の特徴量を扱えるらしい
- DAGの矢印の「強さ」はどう表現している？
  - CausalNexではその「強さ」を表現することができている
    - Sensitivity
- Target Leakの検出可能性
  - 交絡とかかわる問題と認識
- 他の因果推論ライブラリとの競合
  - Treatment Effectに特化したライブラリ
  - CausalNexはCounterFactualに特化している
- バックドア変数の取扱いについて
  - 現状対応していない。開発中。
- Rでのパッケージ化
  - ないです
- CausalNexは非定常の時系列データに対応できますか！？
  - 時系列には対応していないっぽいね。
  - 動的ベイジアンネットワークという別のフレームの話になります。
  - 頑張って実装するかもしれない。
- CausalNexで因果関係を学習して、それを元に変数を選択して、より精密に求めるのは可能か？
  - 運用上は可能。
  - 同様のパフォーマンスが得られるかはまた別の問題
- 想定する客
  - Pythonライブラリなので、Pythonが使える人が前提
  - データに関する理解があり、ベイジアンネットワークの活用経験がある人
  - 追加してPytorchなど、実装に詳しい人がいるとよりよい。